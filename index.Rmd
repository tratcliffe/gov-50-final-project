---
title: "Gov 50 Final Project"
author: "Talulah Ratcliffe"
description: "My final project"
output:
  distill::distill_article:
    self_contained: false
---

## Introduction
Is the inclusion of 'Diversity, Equity and Inclusion' within K-12 School District mission statements affected by party, race and income? In this study, I plan to examine the extent to which socioeconomic and partisan factors of a given school district in the US, influences whether or not values of diversity, equity and inclusion are included in their mission statements. 

I hypothesize that there will not only be a correlation between party and race/income, but that Republican districts, particularly those with higher proportions of white, upper-class students, will be less likely to include Diversity, Equity and Inclusion within their mission statements. 

As seen through the Affirmative Action case this year, conservative ideology tends to value race-blind and, more generally, identity-blind policies and values. Policies (with a school Mission statement replicating the effect of a legal imposition) which attempt to fundamentally interfere with objective principles which equally apply to all, are usually rejected by Republicans, as well as privileged racial and economic groups. 

My representative sample is comprised of 1314 mission statements from regular public school districts, whose mission statements were published online as of November 2022. The schools were chosen from a comprehensive list maintained by the National Center for Education Statistics. My unit of analysis is a Mission Statement. The explanatory variable of interest is whether values of diversity, equity or inclusion are included. The variable is coded = 1 for included, and = 0 for excluded. There are several key words that will indicate these values (closing gap, culture, diversity, equity, inclusion, nationality, race). My main outcome variable is the party of the district - Republican or Democrat. This is reflected through whether the majority of residents voted for Donald Trump or Joe Biden in the 2020 presidential election, and is calculated using 2020 General Election Results Disaggregated to 2020 Census Blocks Datasets available through the Redistricting Data Hub. Population data includes median income and share of white residents, and was accessed from the 2015-2019 American Community Survey estimates published by the Census Bureau. 

If I observe less inclusion of diversity, inclusion and equity values in Mission Statements within Republican, upper-class and predominately white districts, this would provide support for my hypothesis. On the other hand, if I observe less inclusion of diversity, inclusion and equity values in Mission Statements within Democratic, lower-class and predominately non-white school districts, this would provide evidence against my hypothesis. 

```{r, echo=FALSE}
library(tidyverse)
diversity_data <- read.csv("data/district_tabular_data.csv")
```


```{r, echo=FALSE}
diversity_data <- diversity_data |>
  select(topic_diversity_equity_and_inclusion, majority_vote, white_share_category, hh_median_income_category)
```

## Data 

```{r, echo=FALSE}
div_count <- diversity_data |>
  group_by(majority_vote) |>
  filter(!is.na(majority_vote), topic_diversity_equity_and_inclusion == 1) |>
  count()

ggplot(div_count, aes(x = majority_vote, y = n)) +
  geom_bar(stat = "identity", fill = c("democratic" = "blue", "republican" = "red")) +
  labs(
    title = "Diversity, Equity and Inclusion Topic by Party",
    x = "Party Affiliation",
    y = "Number of Mentions"
  ) +
  scale_x_discrete(labels = c("democratic" = "Democratic", "republican" = "Republican")) +
  theme_minimal() 
```

This graph shows a comparison of democratic and republican inclusions of diversity, equity or inclusion topics within their mission statements. It is the beginning of an exploration between party affiliation and an educational focus on these topics, and suggests that being democratic increases a school district's tendency to include them. **Note if cross-sectional

## Results

```{r, echo=FALSE}
income_table <- diversity_data |>
  mutate(Income = case_when(
  hh_median_income_category %in% c("low_median_income") ~ "Low Median Income",
  hh_median_income_category %in% c("medium_median_income") ~ "Medium Median Income",
  hh_median_income_category %in% c("high_median_income") ~ "High Median Income"),
    Party = case_when(
      majority_vote == "republican" ~ "Republican",
      majority_vote == "democratic" ~ "Democratic",
      NA ~ "Other"
    )) |>
  group_by(Party, Income) |>
  summarize(n = n()) |>
  mutate(prop = n / sum(n)) |>
  select(-n) |>
  pivot_wider(
    names_from = Party,
    values_from = prop
  ) |>
select(Income, Democratic, Republican)
knitr::kable(income_table)
```
```{r, echo=FALSE}
party_income <- income_table |>
  pivot_longer(cols = c("Democratic", "Republican"), names_to = "Party", values_to = "Proportion")

ggplot(race_party_income, aes(x = Income, y = Proportion, fill = Party)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(
    title = "Proportion of Democratic and Republican Voters by Income",
    x = "Income Group",
    y = "Proportion"
  ) +
  scale_fill_manual(values = c("Democratic" = "blue", "Republican" = "red")) +
  theme_minimal()
```


This cross-tab proportion table, and accompanying graph, examines how income levels differ by party, in an attempt to see if there is a connection between the two. It does so by showing the proportion of each party within each income group. Both table and graph show that both the high and low median income individuals have a relatively balanced distribution between Democrats and Republicans. However, the proportion of democrats is higher than republicans in both income categories, with the difference being slightly higher in the high income group. However, the medium median income group shows the largest disparity, with most being Republican. Knowing this, I plan to examine if both income and party influence whether or not diversity is talked about in their statements. 

The implied connection between income group and party, wherein districts with higher median incomes are predominately democratic, districts with lower median incomes are predominately democratic, and districts with medium median incomes are predominately republican, is not entirely aligned with my hypothesis. I hypothesized that a higher median income would be associated with Republican districts, but that is more true for medium income / middle-class districts. However, my assumed grouping of low median income groups with democratic areas is plausible based on this analysis. 


```{r, echo=FALSE}
diversity_data |>
  drop_na(majority_vote, white_share_category) |>
  count(majority_vote, white_share_category) |>
ggplot(mapping = aes(x = white_share_category, y = n, fill = majority_vote)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Correlation between Party and Race",
       x = "Predominant Race of District Residents",
       y = "Frequency",
       fill = "Party Affiliation") +
  scale_fill_manual(values = c("democratic" = "blue", "republican" = "red"),
                    name = "Party Affiliation",
                    labels = c("democratic" = "Democratic", "republican" = "Republican")) +
  scale_x_discrete(labels = c("low_share" = "Predominately Non-White Population", "high_share" = "Predominately White Population")) +
  theme_minimal()
```
This graph investigates if there is a connection between party affiliation and race within a given school district. There is a significant difference in the number of democratic and republican areas when the population is predominately non-white: there are more democratic areas that are predominately non-white, than there are republican areas. In comparison, there are far more republican areas when the population is predominately white, and the difference is even more pronounced. Notably, there are less overall values in the predominately white population category, which could suggest an imbalance in the data. 

The implied connection between race and party, wherein districts with a higher proportion of white residents tend to be republican, and districts with a lower proportion of white residents tend to be democratic, aligns with my hypothesis which grouped these two variables together.  


```{r, echo=FALSE}
combined_table <- diversity_data %>%
  mutate(
    Income = case_when(
      hh_median_income_category %in% c("low_median_income") ~ "Low Median Income",
      hh_median_income_category %in% c("medium_median_income") ~ "Medium Median Income",
      hh_median_income_category %in% c("high_median_income") ~ "High Median Income"
    ),
    Party = case_when(
      majority_vote == "republican" ~ "Republican",
      majority_vote == "democratic" ~ "Democratic",
      NA ~ "Other"
    )
  ) %>%
  group_by(white_share_category, Party, Income) %>%
  summarize(prop = n() / nrow(.))

filtered_data <- combined_table %>%
  filter(Party %in% c("Democratic", "Republican"))

ggplot(filtered_data, aes(x = Income, y = prop, fill = Party)) +
  geom_bar(stat = "identity", position = "dodge", color = "black", width = 0.7) +
  labs(
    title = "Proportions of Democratic and Republican Voters by Income and Race",
    x = "Income Category",
    y = "Proportion"
  ) +
  scale_fill_manual(values = c("Democratic" = "blue", "Republican" = "red")) +
  facet_grid(white_share_category ~ ., scales = "free_y", space = "free_y", switch = "y", labeller = labeller(white_share_category = c("low_share" = "Predominately Non-White Population", "high_share" = "Predominately White Population"))) +
  theme_minimal() +
  theme(strip.text = element_text(size = 8))
```
This graph groups all 3 variables: race, party and income group, to assess if there are any consistent demographic links. The results indicate the following: High income, predominately non-white districts are mostly democratic. High income, predominately white districts are mostly republican. Low income, predominately non-white districts are mostly democratic. Low income, predominately white districts are mostly republican. Medium income, predominately non-white districts are mostly democratic. Medium income, predominately white districts are mostly republican. This indicates that across income groups, race is the predominate factor in predicting party affiliation. However, the medium income group does produce a much higher proportion of republicans. 

Now, I want to connect these unique groups with whether or not they included the topics of diversity, equity or inclusion in their mission statements. In particular, my hypothesis suggested that high income, Republican districts, with predominately white populations, would be the least likely to include Diversity, Equity and Inclusion within their mission statement. 


```{r}
count_by_group <- diversity_data |>
  na.omit() |>
  group_by(hh_median_income_category, white_share_category, majority_vote) |>
  summarize(count = sum(topic_diversity_equity_and_inclusion == 1)) |>
  mutate(
    hh_median_income_category = case_when(
      hh_median_income_category == "low_median_income" ~ "Low Income",
      hh_median_income_category == "medium_median_income" ~ "Medium Income",
      hh_median_income_category == "high_median_income" ~ "High Income",
      TRUE ~ hh_median_income_category
    ),
    white_share_category = case_when(
      white_share_category == "low_share" ~ "Mostly White",
      white_share_category == "high_share" ~ "Mostly Non-White",
      TRUE ~ white_share_category
    ),
    majority_vote = case_when(
      majority_vote == "republican" ~ "Republican",
      majority_vote == "democratic" ~ "Democratic",
      TRUE ~ majority_vote
    )
  ) |>
  arrange(desc(count))

knitr::kable(count_by_group, col.names = c("Income Group", "Predominate Race", "Party", "Count"),
             caption = "**Summary of DEI Topics Mentions by Income Group, Predominate Race, and Party**")
```
These findings organize the unique socioeconomic/partisan groups from most inclusions of DEI topics, to least. It reveals that the group with the most DEI topic mentions was mostly white, democratic, medium income districts, closely followed by mostly white, high income, democratic districts. The least likely to include DEI topics in their mission statements were low income and medium income, mostly non-white, democratic districts. Interestingly, all republican districts fell in the middle of the distribution, regardless of race breakdown. 

To further investigate whether party is the main variable of interest, accounting for race and income, a regression is useful. 

```{r}
library(gt)
party_reg <- lm(topic_diversity_equity_and_inclusion ~ majority_vote + white_share_category + hh_median_income_category, data = diversity_data)
tidy_regression <- tidy(party_reg)

tidy_regression |>
  gt() |>
  tab_header(
    title = "Regression Results",
    subtitle = "Predicting Inclusion of DEI Topics"
  ) |>
  fmt_number(
    columns = vars(estimate, std.error, statistic, p.value),
    decimals = 3
  )
```
This regression has an intercept of 0.495. This means that when all other variables (party, race, and income) are at their reference levels, which would represent mostly white residents, a high median income, and a Democratic district, the estimated value of the inclusion of DEI topics is approximately 0.495. This value is closer to 0 (not including) than 1 (including), suggesting that, on average, areas with predominantly white residents, high median income, and a Democratic majority are less likely to include Diversity, Equity, and Inclusion (DEI) topics in their mission statements compared to the overall average. 

The estimate for majority_voterepublican is -0.236. This means that when all other variables are held constant, the estimated change in the inclusion of DEI topics with a Republican, rather than Democratic, majority is -0.2359. In other words, on average, areas with a Republican majority are 23.59% less likely to include DEI topics compared to a district with a Democratic majority, holding all other factors constant. (GOOD FOR MY HYPOTHESIS)

The estimate for white_share_categorylow_share is 0.166. This means that when all other variables are held constant, the estimated change in the inclusion of DEI topics with a low share of white residents rather than a high share, is approximately 0.1664. In other words, on average, areas with mostly non-white residents are 16.64% more likely to include DEI topics compared to a district with mostly white residents, holding all other factors constant. (GOOD FOR MY HYPOTHESIS)


The estimate for hh_median_income_categorylow_median_income is -0.080. This means that when all other variables are held constant, the estimated change in the inclusion of DEI topics with a low median income (compared to a high median income), is approximately -0.080. In other words, on average, low income districts are 8% less likely to include DEI topics than high income districts, holding all other factors constant. (BAD FOR MY HYPOTHESIS - I THOUGHT LOW INCOME WOULD BE MORE LIKELY THAN HIGH)

The estimate for hh_median_income_categorymedium_median_income is -0.008. This means that when all other variables are held constant, the estimated change in the inclusion of DEI topics with a medium median income (compared to a high median income), is approximately -0.008. In other words, on average, medium income districts are 0.8% less likely to include DEI topics than high income districts, holding all other factors constant. (BAD FOR MY HYPOTHESIS - I THOUGHT HIGH INCOME WOULD BE LEAST LIKELY TO INCLUDE DEI BUT ITS MOST)



